import numpy as np

class cov_WAGR:
    @staticmethod
    def l00(cosmo_funcs_list,t1,t2,t3,t4,k1,zz=0):
        Pk,f,D1,b1,b11,gr1,_,gr11,_,Pkd,_,d = cosmo_funcs_list[t1][t2].unpack_pk(k1,zz,GR=True,WS=True)
        _,_,_,b12,b13,gr12,_,gr13,_ = cosmo_funcs_list[t1][t2].unpack_pk(k1,zz,GR=True)

        n13 = 1/cosmo_funcs_list[t1][t3].n_g(zz)
        n14 = 1/cosmo_funcs_list[t1][t4].n_g(zz)
        n23 = 1/cosmo_funcs_list[t2][t3].n_g(zz)
        n24 = 1/cosmo_funcs_list[t2][t4].n_g(zz)
        
        expr = 2*D1**2*(-5*D1**2*Pk*f**3*(Pk + 2*Pkd*k1)*(2*gr1 - 6*gr11 + gr12 + gr13) - 9*D1**2*Pk*f**2*(Pk + 2*Pkd*k1)*(b1*(-2*gr11 + gr12 + gr13) + b11*(6*gr1 + gr12 + gr13) - b12*(4*gr11 + gr13)) + 105*b1*(Pk + Pkd*k1)*(gr12*n24 + gr13*n23) - 105*b12*(-D1**2*Pk*b1*b11*gr13*(Pk + 2*Pkd*k1) + gr1*n24*(Pk + Pkd*k1) + gr11*n14*(Pk + Pkd*k1)) - 3*b13*(-D1**2*Pk*gr12*(Pk + 2*Pkd*k1)*(7*b1*(5*b11 + f) + f*(7*b11 + 3*f)) + 7*gr1*(2*D1**2*Pk*(Pk + 2*Pkd*k1)*(5*b11*b12 + 2*b11*f - b12*f) + 5*n23*(Pk + Pkd*k1)) + gr11*(2*D1**2*Pk*(Pk + 2*Pkd*k1)*(35*b1*b12 - f*(7*b12 + 6*f)) + 35*n13*(Pk + Pkd*k1))) - 21*f*(D1**2*Pk**2*b1*b11*gr12 + 4*D1**2*Pk**2*b11*b12*gr1 + 2*D1**2*Pk*Pkd*b1*b11*gr12*k1 + 8*D1**2*Pk*Pkd*b11*b12*gr1*k1 + 3*Pk*gr1*n23 + 3*Pk*gr1*n24 - 2*Pk*gr12*n14 - 3*Pk*gr12*n24 + 3*Pkd*gr1*k1*n23 + 3*Pkd*gr1*k1*n24 - 2*Pkd*gr12*k1*n14 - 3*Pkd*gr12*k1*n24 + gr11*(Pk + Pkd*k1)*(n13 + n14) + gr13*(D1**2*Pk*(Pk + 2*Pkd*k1)*(b1*(b11 - b12) - b11*b12) - 2*n13*(Pk + Pkd*k1) - 3*n23*(Pk + Pkd*k1))))/(315*d*k1**2)
        return expr
    
    @staticmethod
    def l11(cosmo_funcs_list,t1,t2,t3,t4,k1,zz=0):
        Pk,f,D1,b1,b11,gr1,_,gr11,_,Pkd,_,d = cosmo_funcs_list[t1][t2].unpack_pk(k1,zz,GR=True,WS=True)
        _,_,_,b12,b13,gr12,_,gr13,_ = cosmo_funcs_list[t1][t2].unpack_pk(k1,zz,GR=True)

        n13 = 1/cosmo_funcs_list[t1][t3].n_g(zz)
        n14 = 1/cosmo_funcs_list[t1][t4].n_g(zz)
        n23 = 1/cosmo_funcs_list[t2][t3].n_g(zz)
        n24 = 1/cosmo_funcs_list[t2][t4].n_g(zz)
        
        expr = 2*D1**2*(35*D1**2*Pk*f**3*(Pk + 2*Pkd*k1)*(gr1 - gr11 + 2*gr12 - 2*gr13) + 55*D1**2*Pk*f**2*(Pk + 2*Pkd*k1)*(-b1*(gr11 + 2*gr12 - 2*gr13) + b11*(gr1 + 6*gr12 - 6*gr13) + 3*b12*(gr1 - gr11)) - 11*b13*(36*D1**2*Pk*f*gr12*(Pk + 2*Pkd*k1)*(b1 - b11) - D1**2*Pk*gr1*(Pk + 2*Pkd*k1)*(21*b11*b12 - 9*b11*f + 9*b12*f - 5*f**2) + D1**2*Pk*gr11*(Pk + 2*Pkd*k1)*(21*b1*b12 - 9*b1*f + 9*b12*f - 5*f**2) - 21*gr1*n23*(Pk + Pkd*k1) + 42*gr11*n13*(Pk + Pkd*k1)) - 99*f*(-2*D1**2*Pk**2*b1*b11*gr12 - 3*D1**2*Pk**2*b11*b12*gr1 - 4*D1**2*Pk*Pkd*b1*b11*gr12*k1 - 6*D1**2*Pk*Pkd*b11*b12*gr1*k1 - 3*Pk*gr1*n23 + 2*Pk*gr1*n24 + 2*Pk*gr12*n14 - 2*Pk*gr12*n24 - 3*Pkd*gr1*k1*n23 + 2*Pkd*gr1*k1*n24 + 2*Pkd*gr12*k1*n14 - 2*Pkd*gr12*k1*n24 + gr11*(3*D1**2*Pk*b1*b12*(Pk + 2*Pkd*k1) + 2*n13*(Pk + Pkd*k1) - n14*(Pk + Pkd*k1)) + gr13*(2*D1**2*Pk*(Pk + 2*Pkd*k1)*(b1*(b11 - 2*b12) + 2*b11*b12) - 3*n13*(Pk + Pkd*k1) + 3*n23*(Pk + Pkd*k1))) + 231*(Pk + Pkd*k1)*(-b1*gr13*n23 + b11*gr13*n13 + b12*gr11*n14))/(385*d*k1**2)
        return expr
    
class cov_RRGR:
    @staticmethod
    def l00(cosmo_funcs_list,t1,t2,t3,t4,k1,zz=0):   
        Pk,f,D1,b1,b11,gr1,_,gr11,_,Pkd,Pkdd,d,fd,Dd,bd1,bd11,_,_,_,_,grd1,grd11 = cosmo_funcs_list[t1][t2].unpack_pk(k1,zz,RR=True,GR=True)
        _,_,_,b12,b13,gr12,_,gr13,_,_,_,_,_,_,bd12,bd13,_,_,_,_,grd12,grd13 = cosmo_funcs_list[t3][t4].unpack_pk(k1,zz,RR=True,GR=True)

        n13 = 1/cosmo_funcs_list[t1][t3].n_g(zz)
        n14 = 1/cosmo_funcs_list[t1][t4].n_g(zz)
        n23 = 1/cosmo_funcs_list[t2][t3].n_g(zz)
        n24 = 1/cosmo_funcs_list[t2][t4].n_g(zz)
        
        expr = D1*(D1*(-105*D1**2*Pk**2*b1*b11*b12*grd13 + 105*D1**2*Pk**2*b1*b11*bd12*gr13 + 105*D1**2*Pk**2*b1*b11*bd13*gr12 - 63*D1**2*Pk**2*b1*b11*f*grd12 - 63*D1**2*Pk**2*b1*b11*f*grd13 - 105*D1**2*Pk**2*b1*b12*bd13*gr11 + 126*D1**2*Pk**2*b1*b12*f*grd11 - 63*D1**2*Pk**2*b1*b12*f*grd13 - 63*D1**2*Pk**2*b1*bd12*f*gr11 + 63*D1**2*Pk**2*b1*bd12*f*gr13 - 63*D1**2*Pk**2*b1*bd13*f*gr11 + 63*D1**2*Pk**2*b1*bd13*f*gr12 + 90*D1**2*Pk**2*b1*f**2*grd11 - 45*D1**2*Pk**2*b1*f**2*grd12 - 45*D1**2*Pk**2*b1*f**2*grd13 + 105*D1**2*Pk**2*b11*b12*bd13*gr1 + 126*D1**2*Pk**2*b11*b12*f*gr1d - 63*D1**2*Pk**2*b11*b12*f*grd13 + 63*D1**2*Pk**2*b11*bd12*f*gr1 + 63*D1**2*Pk**2*b11*bd12*f*gr13 + 63*D1**2*Pk**2*b11*bd13*f*gr1 + 63*D1**2*Pk**2*b11*bd13*f*gr12 + 90*D1**2*Pk**2*b11*f**2*gr1d - 45*D1**2*Pk**2*b11*f**2*grd12 - 45*D1**2*Pk**2*b11*f**2*grd13 - 126*D1**2*Pk**2*b12*bd1*f*gr11 + 63*D1**2*Pk**2*b12*bd13*f*gr1 - 63*D1**2*Pk**2*b12*bd13*f*gr11 + 90*D1**2*Pk**2*b12*f**2*gr1d + 90*D1**2*Pk**2*b12*f**2*grd11 - 45*D1**2*Pk**2*b12*f**2*grd13 - 90*D1**2*Pk**2*bd1*f**2*gr11 + 45*D1**2*Pk**2*bd12*f**2*gr1 - 45*D1**2*Pk**2*bd12*f**2*gr11 + 45*D1**2*Pk**2*bd12*f**2*gr13 + 45*D1**2*Pk**2*bd13*f**2*gr1 - 45*D1**2*Pk**2*bd13*f**2*gr11 + 45*D1**2*Pk**2*bd13*f**2*gr12 + 70*D1**2*Pk**2*f**3*gr1d + 70*D1**2*Pk**2*f**3*grd11 - 35*D1**2*Pk**2*f**3*grd12 - 35*D1**2*Pk**2*f**3*grd13 + 210*D1**2*Pk*Pkd*b1*b11*b12*grd13*k1 - 210*D1**2*Pk*Pkd*b1*b11*bd12*gr13*k1 - 210*D1**2*Pk*Pkd*b1*b11*bd13*gr12*k1 + 126*D1**2*Pk*Pkd*b1*b11*f*grd12*k1 + 126*D1**2*Pk*Pkd*b1*b11*f*grd13*k1 + 210*D1**2*Pk*Pkd*b1*b12*bd13*gr11*k1 - 252*D1**2*Pk*Pkd*b1*b12*f*grd11*k1 + 126*D1**2*Pk*Pkd*b1*b12*f*grd13*k1 + 126*D1**2*Pk*Pkd*b1*bd12*f*gr11*k1 - 126*D1**2*Pk*Pkd*b1*bd12*f*gr13*k1 + 126*D1**2*Pk*Pkd*b1*bd13*f*gr11*k1 - 126*D1**2*Pk*Pkd*b1*bd13*f*gr12*k1 - 180*D1**2*Pk*Pkd*b1*f**2*grd11*k1 + 90*D1**2*Pk*Pkd*b1*f**2*grd12*k1 + 90*D1**2*Pk*Pkd*b1*f**2*grd13*k1 - 210*D1**2*Pk*Pkd*b11*b12*bd13*gr1*k1 - 252*D1**2*Pk*Pkd*b11*b12*f*gr1d*k1 + 126*D1**2*Pk*Pkd*b11*b12*f*grd13*k1 - 126*D1**2*Pk*Pkd*b11*bd12*f*gr1*k1 - 126*D1**2*Pk*Pkd*b11*bd12*f*gr13*k1 - 126*D1**2*Pk*Pkd*b11*bd13*f*gr1*k1 - 126*D1**2*Pk*Pkd*b11*bd13*f*gr12*k1 - 180*D1**2*Pk*Pkd*b11*f**2*gr1d*k1 + 90*D1**2*Pk*Pkd*b11*f**2*grd12*k1 + 90*D1**2*Pk*Pkd*b11*f**2*grd13*k1 + 252*D1**2*Pk*Pkd*b12*bd1*f*gr11*k1 - 126*D1**2*Pk*Pkd*b12*bd13*f*gr1*k1 + 126*D1**2*Pk*Pkd*b12*bd13*f*gr11*k1 - 180*D1**2*Pk*Pkd*b12*f**2*gr1d*k1 - 180*D1**2*Pk*Pkd*b12*f**2*grd11*k1 + 90*D1**2*Pk*Pkd*b12*f**2*grd13*k1 + 180*D1**2*Pk*Pkd*bd1*f**2*gr11*k1 - 90*D1**2*Pk*Pkd*bd12*f**2*gr1*k1 + 90*D1**2*Pk*Pkd*bd12*f**2*gr11*k1 - 90*D1**2*Pk*Pkd*bd12*f**2*gr13*k1 - 90*D1**2*Pk*Pkd*bd13*f**2*gr1*k1 + 90*D1**2*Pk*Pkd*bd13*f**2*gr11*k1 - 90*D1**2*Pk*Pkd*bd13*f**2*gr12*k1 - 140*D1**2*Pk*Pkd*f**3*gr1d*k1 - 140*D1**2*Pk*Pkd*f**3*grd11*k1 + 70*D1**2*Pk*Pkd*f**3*grd12*k1 + 70*D1**2*Pk*Pkd*f**3*grd13*k1 - 105*Pk*b1*grd12*n24 - 105*Pk*b1*grd13*n23 + 105*Pk*b12*gr1d*n24 + 105*Pk*b12*grd11*n14 - 105*Pk*bd1*gr12*n24 - 105*Pk*bd1*gr13*n23 + 105*Pk*bd12*gr1*n24 + 105*Pk*bd13*gr1*n23 + 63*Pk*f*gr1d*n23 + 63*Pk*f*gr1d*n24 + 63*Pk*f*grd11*n13 + 63*Pk*f*grd11*n14 - 63*Pk*f*grd12*n24 - 63*Pk*f*grd13*n23 + 105*Pkd*b1*grd12*k1*n24 + 105*Pkd*b1*grd13*k1*n23 - 105*Pkd*b12*gr1d*k1*n24 - 105*Pkd*b12*grd11*k1*n14 + 105*Pkd*bd1*gr12*k1*n24 + 105*Pkd*bd1*gr13*k1*n23 - 105*Pkd*bd12*gr1*k1*n24 - 105*Pkd*bd13*gr1*k1*n23 - 63*Pkd*f*gr1d*k1*n23 - 63*Pkd*f*gr1d*k1*n24 - 63*Pkd*f*grd11*k1*n13 - 63*Pkd*f*grd11*k1*n14 + 63*Pkd*f*grd12*k1*n24 + 63*Pkd*f*grd13*k1*n23 - 3*bd11*(6*D1**2*Pk*f*gr1*(Pk - 2*Pkd*k1)*(7*b12 + 5*f) + 35*gr12*n14*(Pk - Pkd*k1) + 35*gr13*n13*(Pk - Pkd*k1)) + fd*(63*D1**2*Pk**2*b1*b11*gr12 - 63*D1**2*Pk**2*b1*b12*gr11 - 90*D1**2*Pk**2*b1*f*gr11 + 45*D1**2*Pk**2*b1*f*gr12 + 63*D1**2*Pk**2*b11*b12*gr1 + 90*D1**2*Pk**2*b11*f*gr1 + 45*D1**2*Pk**2*b11*f*gr12 - 45*D1**2*Pk**2*b12*f*gr1 - 135*D1**2*Pk**2*b12*f*gr11 - 140*D1**2*Pk**2*f**2*gr11 + 35*D1**2*Pk**2*f**2*gr12 - 126*D1**2*Pk*Pkd*b1*b11*gr12*k1 + 126*D1**2*Pk*Pkd*b1*b12*gr11*k1 + 180*D1**2*Pk*Pkd*b1*f*gr11*k1 - 90*D1**2*Pk*Pkd*b1*f*gr12*k1 - 126*D1**2*Pk*Pkd*b11*b12*gr1*k1 - 180*D1**2*Pk*Pkd*b11*f*gr1*k1 - 90*D1**2*Pk*Pkd*b11*f*gr12*k1 + 90*D1**2*Pk*Pkd*b12*f*gr1*k1 + 270*D1**2*Pk*Pkd*b12*f*gr11*k1 + 280*D1**2*Pk*Pkd*f**2*gr11*k1 - 70*D1**2*Pk*Pkd*f**2*gr12*k1 + 63*Pk*gr1*n23 + 63*Pk*gr1*n24 - 63*Pk*gr12*n14 - 63*Pk*gr12*n24 - 63*Pkd*gr1*k1*n23 - 63*Pkd*gr1*k1*n24 + 63*Pkd*gr12*k1*n14 + 63*Pkd*gr12*k1*n24 + gr13*(D1**2*Pk*(Pk - 2*Pkd*k1)*(9*b1*(7*b11 + 5*f) + 5*f*(9*b11 + 7*f)) - 63*n13*(Pk - Pkd*k1) - 63*n23*(Pk - Pkd*k1)))) + Dd*(70*D1**2*Pk*f**3*(Pk - 2*Pkd*k1)*(gr1 - gr11) + 90*D1**2*Pk*f**2*(Pk - 2*Pkd*k1)*(-b1*gr11 + b11*gr1 + b12*(gr1 - gr11)) + 63*f*(2*D1**2*Pk**2*b11*b12*gr1 - 4*D1**2*Pk*Pkd*b11*b12*gr1*k1 + 2*Pk*gr1*n23 + 2*Pk*gr1*n24 - Pk*gr12*n14 - 2*Pk*gr12*n24 - 2*Pkd*gr1*k1*n23 - 2*Pkd*gr1*k1*n24 + Pkd*gr12*k1*n14 + 2*Pkd*gr12*k1*n24 + gr11*(-2*D1**2*Pk*b1*b12*(Pk - 2*Pkd*k1) + n13*(Pk - Pkd*k1) + n14*(Pk - Pkd*k1)) - gr13*(Pk - Pkd*k1)*(n13 + 2*n23)) - 105*(Pk - Pkd*k1)*(2*b1*gr12*n24 + 2*b1*gr13*n23 + b11*gr12*n14 + b11*gr13*n13 - 2*b12*gr1*n24 - b12*gr11*n14)) + 3*b13*(D1*(-D1**2*Pk*(Pk - 2*Pkd*k1)*(35*b1*bd12*gr11 + 21*b1*f*grd12 + 21*b1*fd*gr11 - 7*b11*(-5*b1*grd12 + 5*bd12*gr1 - 3*f*grd12 + 3*fd*gr1) + 14*b12*(5*bd1*gr11 + 5*bd11*gr1 + 3*fd*(gr1 + gr11)) + 42*bd1*f*gr11 + 42*bd11*f*gr1 - 21*bd12*f*gr1 + 21*bd12*f*gr11 + 15*f**2*grd12 + 15*f*fd*gr1 + 45*f*fd*gr11) + gr1d*(2*D1**2*Pk*(Pk - 2*Pkd*k1)*(7*b11*(5*b12 + 3*f) + 3*f*(7*b12 + 5*f)) + 35*n23*(Pk - Pkd*k1)) + grd11*(2*D1**2*Pk*(Pk - 2*Pkd*k1)*(7*b1*(5*b12 + 3*f) + 3*f*(7*b12 + 5*f)) + 35*n13*(Pk - Pkd*k1))) + Dd*(2*D1**2*Pk*gr1*(Pk - 2*Pkd*k1)*(7*b11*(5*b12 + 3*f) + 3*f*(7*b12 + 5*f)) - 2*D1**2*Pk*gr11*(Pk - 2*Pkd*k1)*(7*b1*(5*b12 + 3*f) + 3*f*(7*b12 + 5*f)) + 70*gr1*n23*(Pk - Pkd*k1) + 35*gr11*n13*(Pk - Pkd*k1))))/(315*d*k1**2)
        return expr
    
    @staticmethod
    def l11(cosmo_funcs_list,t1,t2,t3,t4,k1,zz=0):
        Pk,f,D1,b1,b11,gr1,_,gr11,_,Pkd,Pkdd,d,fd,Dd,bd1,bd11,_,_,_,_,grd1,grd11 = cosmo_funcs_list[t1][t2].unpack_pk(k1,zz,RR=True,GR=True)
        _,_,_,b12,b13,gr12,_,gr13,_,_,_,_,_,_,bd12,bd13,_,_,_,_,grd12,grd13 = cosmo_funcs_list[t3][t4].unpack_pk(k1,zz,RR=True,GR=True)

        n13 = 1/cosmo_funcs_list[t1][t3].n_g(zz)
        n14 = 1/cosmo_funcs_list[t1][t4].n_g(zz)
        n23 = 1/cosmo_funcs_list[t2][t3].n_g(zz)
        n24 = 1/cosmo_funcs_list[t2][t4].n_g(zz)
        
        expr = D1*(D1*(693*D1**2*Pk**2*b1*b11*b12*grd13 + 693*D1**2*Pk**2*b1*b11*bd12*gr13 - 693*D1**2*Pk**2*b1*b11*bd13*gr12 - 495*D1**2*Pk**2*b1*b11*f*grd12 + 495*D1**2*Pk**2*b1*b11*f*grd13 + 693*D1**2*Pk**2*b1*b12*bd13*gr11 + 495*D1**2*Pk**2*b1*b12*f*grd13 - 495*D1**2*Pk**2*b1*bd12*f*gr11 + 495*D1**2*Pk**2*b1*bd12*f*gr13 + 495*D1**2*Pk**2*b1*bd13*f*gr11 - 495*D1**2*Pk**2*b1*bd13*f*gr12 - 385*D1**2*Pk**2*b1*f**2*grd12 + 385*D1**2*Pk**2*b1*f**2*grd13 + 1386*D1**2*Pk**2*b11*b12*bd1*gr13 - 693*D1**2*Pk**2*b11*b12*bd13*gr1 + 495*D1**2*Pk**2*b11*b12*f*grd13 - 990*D1**2*Pk**2*b11*bd1*f*gr12 + 990*D1**2*Pk**2*b11*bd1*f*gr13 + 495*D1**2*Pk**2*b11*bd12*f*gr1 + 495*D1**2*Pk**2*b11*bd12*f*gr13 - 495*D1**2*Pk**2*b11*bd13*f*gr1 - 495*D1**2*Pk**2*b11*bd13*f*gr12 - 385*D1**2*Pk**2*b11*f**2*grd12 + 385*D1**2*Pk**2*b11*f**2*grd13 + 990*D1**2*Pk**2*b12*bd1*f*gr13 - 495*D1**2*Pk**2*b12*bd13*f*gr1 + 495*D1**2*Pk**2*b12*bd13*f*gr11 + 385*D1**2*Pk**2*b12*f**2*grd13 - 770*D1**2*Pk**2*bd1*f**2*gr12 + 770*D1**2*Pk**2*bd1*f**2*gr13 + 385*D1**2*Pk**2*bd12*f**2*gr1 - 385*D1**2*Pk**2*bd12*f**2*gr11 + 385*D1**2*Pk**2*bd12*f**2*gr13 - 385*D1**2*Pk**2*bd13*f**2*gr1 + 385*D1**2*Pk**2*bd13*f**2*gr11 - 385*D1**2*Pk**2*bd13*f**2*gr12 - 315*D1**2*Pk**2*f**3*grd12 + 315*D1**2*Pk**2*f**3*grd13 - 1386*D1**2*Pk*Pkd*b1*b11*b12*grd13*k1 - 1386*D1**2*Pk*Pkd*b1*b11*bd12*gr13*k1 + 1386*D1**2*Pk*Pkd*b1*b11*bd13*gr12*k1 + 990*D1**2*Pk*Pkd*b1*b11*f*grd12*k1 - 990*D1**2*Pk*Pkd*b1*b11*f*grd13*k1 - 1386*D1**2*Pk*Pkd*b1*b12*bd13*gr11*k1 - 990*D1**2*Pk*Pkd*b1*b12*f*grd13*k1 + 990*D1**2*Pk*Pkd*b1*bd12*f*gr11*k1 - 990*D1**2*Pk*Pkd*b1*bd12*f*gr13*k1 - 990*D1**2*Pk*Pkd*b1*bd13*f*gr11*k1 + 990*D1**2*Pk*Pkd*b1*bd13*f*gr12*k1 + 770*D1**2*Pk*Pkd*b1*f**2*grd12*k1 - 770*D1**2*Pk*Pkd*b1*f**2*grd13*k1 - 2772*D1**2*Pk*Pkd*b11*b12*bd1*gr13*k1 + 1386*D1**2*Pk*Pkd*b11*b12*bd13*gr1*k1 - 990*D1**2*Pk*Pkd*b11*b12*f*grd13*k1 + 1980*D1**2*Pk*Pkd*b11*bd1*f*gr12*k1 - 1980*D1**2*Pk*Pkd*b11*bd1*f*gr13*k1 - 990*D1**2*Pk*Pkd*b11*bd12*f*gr1*k1 - 990*D1**2*Pk*Pkd*b11*bd12*f*gr13*k1 + 990*D1**2*Pk*Pkd*b11*bd13*f*gr1*k1 + 990*D1**2*Pk*Pkd*b11*bd13*f*gr12*k1 + 770*D1**2*Pk*Pkd*b11*f**2*grd12*k1 - 770*D1**2*Pk*Pkd*b11*f**2*grd13*k1 - 1980*D1**2*Pk*Pkd*b12*bd1*f*gr13*k1 + 990*D1**2*Pk*Pkd*b12*bd13*f*gr1*k1 - 990*D1**2*Pk*Pkd*b12*bd13*f*gr11*k1 - 770*D1**2*Pk*Pkd*b12*f**2*grd13*k1 + 1540*D1**2*Pk*Pkd*bd1*f**2*gr12*k1 - 1540*D1**2*Pk*Pkd*bd1*f**2*gr13*k1 - 770*D1**2*Pk*Pkd*bd12*f**2*gr1*k1 + 770*D1**2*Pk*Pkd*bd12*f**2*gr11*k1 - 770*D1**2*Pk*Pkd*bd12*f**2*gr13*k1 + 770*D1**2*Pk*Pkd*bd13*f**2*gr1*k1 - 770*D1**2*Pk*Pkd*bd13*f**2*gr11*k1 + 770*D1**2*Pk*Pkd*bd13*f**2*gr12*k1 + 630*D1**2*Pk*Pkd*f**3*grd12*k1 - 630*D1**2*Pk*Pkd*f**3*grd13*k1 - 693*Pk*b1*grd12*n24 + 693*Pk*b1*grd13*n23 + 693*Pk*b12*gr1d*n24 - 693*Pk*b12*grd11*n14 - 693*Pk*bd1*gr12*n24 + 693*Pk*bd1*gr13*n23 + 693*Pk*bd12*gr1*n24 - 693*Pk*bd13*gr1*n23 - 495*Pk*f*gr1d*n23 + 495*Pk*f*gr1d*n24 + 495*Pk*f*grd11*n13 - 495*Pk*f*grd11*n14 - 495*Pk*f*grd12*n24 + 495*Pk*f*grd13*n23 + 693*Pkd*b1*grd12*k1*n24 - 693*Pkd*b1*grd13*k1*n23 - 693*Pkd*b12*gr1d*k1*n24 + 693*Pkd*b12*grd11*k1*n14 + 693*Pkd*bd1*gr12*k1*n24 - 693*Pkd*bd1*gr13*k1*n23 - 693*Pkd*bd12*gr1*k1*n24 + 693*Pkd*bd13*gr1*k1*n23 + 495*Pkd*f*gr1d*k1*n23 - 495*Pkd*f*gr1d*k1*n24 - 495*Pkd*f*grd11*k1*n13 + 495*Pkd*f*grd11*k1*n14 + 495*Pkd*f*grd12*k1*n24 - 495*Pkd*f*grd13*k1*n23 - 11*bd11*(-10*D1**2*Pk*f*gr12*(Pk - 2*Pkd*k1)*(9*b1 + 7*f) + 2*D1**2*Pk*gr13*(Pk - 2*Pkd*k1)*(9*b1*(7*b12 + 5*f) + 5*f*(9*b12 + 7*f)) - 63*gr12*n14*(Pk - Pkd*k1) + 63*gr13*n13*(Pk - Pkd*k1)) - 5*fd*(99*D1**2*Pk**2*b1*b11*gr12 - 99*D1**2*Pk**2*b1*b12*gr11 - 77*D1**2*Pk**2*b1*f*gr12 + 99*D1**2*Pk**2*b11*b12*gr1 + 231*D1**2*Pk**2*b11*f*gr12 + 77*D1**2*Pk**2*b12*f*gr1 - 77*D1**2*Pk**2*b12*f*gr11 + 63*D1**2*Pk**2*f**2*gr12 - 198*D1**2*Pk*Pkd*b1*b11*gr12*k1 + 198*D1**2*Pk*Pkd*b1*b12*gr11*k1 + 154*D1**2*Pk*Pkd*b1*f*gr12*k1 - 198*D1**2*Pk*Pkd*b11*b12*gr1*k1 - 462*D1**2*Pk*Pkd*b11*f*gr12*k1 - 154*D1**2*Pk*Pkd*b12*f*gr1*k1 + 154*D1**2*Pk*Pkd*b12*f*gr11*k1 - 126*D1**2*Pk*Pkd*f**2*gr12*k1 + 99*Pk*gr1*n23 - 99*Pk*gr1*n24 - 99*Pk*gr12*n14 + 99*Pk*gr12*n24 - 99*Pkd*gr1*k1*n23 + 99*Pkd*gr1*k1*n24 + 99*Pkd*gr12*k1*n14 - 99*Pkd*gr12*k1*n24 + gr13*(-D1**2*Pk*(Pk - 2*Pkd*k1)*(11*b1*(9*b11 - 18*b12 - 7*f) + 198*b11*b12 + 231*b11*f + 63*f**2) + 99*n13*(Pk - Pkd*k1) - 99*n23*(Pk - Pkd*k1)))) + Dd*(-630*D1**2*Pk*f**3*(Pk - 2*Pkd*k1)*(gr12 - gr13) - 770*D1**2*Pk*f**2*(Pk - 2*Pkd*k1)*(b1*(gr12 - gr13) + b11*(gr12 - gr13) - b12*gr13) - 693*b11*(-2*D1**2*Pk*b1*b12*gr13*(Pk - 2*Pkd*k1) + gr12*n14*(-Pk + Pkd*k1) + gr13*n13*(Pk - Pkd*k1)) + 495*f*(-2*D1**2*Pk**2*b1*b11*gr12 + 4*D1**2*Pk*Pkd*b1*b11*gr12*k1 - 2*Pk*gr1*n23 + 2*Pk*gr1*n24 + Pk*gr12*n14 - 2*Pk*gr12*n24 + 2*Pkd*gr1*k1*n23 - 2*Pkd*gr1*k1*n24 - Pkd*gr12*k1*n14 + 2*Pkd*gr12*k1*n24 + gr11*(Pk - Pkd*k1)*(n13 - n14) + gr13*(2*D1**2*Pk*(Pk - 2*Pkd*k1)*(b1*(b11 + b12) + b11*b12) + n13*(-Pk + Pkd*k1) + 2*n23*(Pk - Pkd*k1))) - 693*(Pk - Pkd*k1)*(2*b1*gr12*n24 - 2*b1*gr13*n23 - 2*b12*gr1*n24 + b12*gr11*n14)) + 11*b13*(D1**3*Pk*(Pk - 2*Pkd*k1)*(126*b1*bd11*gr12 - 45*b1*f*grd12 - 45*b1*fd*gr11 + 90*b1*fd*gr12 + 9*b11*(-7*b1*grd12 - 14*bd1*gr12 + 7*bd12*gr1 - 5*f*grd12 + 5*fd*(gr1 - 2*gr12)) - 90*bd1*f*gr12 + 90*bd11*f*gr12 + 9*bd12*(-7*b1*gr11 + 5*f*(gr1 - gr11)) - 35*f**2*grd12 + 35*f*fd*gr1 - 35*f*fd*gr11) - 2*D1**2*Dd*Pk*gr12*(Pk - 2*Pkd*k1)*(9*b1*(7*b11 + 5*f) + 5*f*(9*b11 + 7*f)) - 63*D1*gr1d*n23*(Pk - Pkd*k1) + 63*D1*grd11*n13*(Pk - Pkd*k1) - 126*Dd*gr1*n23*(Pk - Pkd*k1) + 63*Dd*gr11*n13*(Pk - Pkd*k1)))/(385*d*k1**2)
        return expr