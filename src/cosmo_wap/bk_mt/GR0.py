import numpy as np
import cosmo_wap.bk as bk
import cosmo_wap
   
#Netwonian, plane parallel constant redshift limit
class NPP:   
    @staticmethod
    def l0(cosmo_funcs,k1,k2,k3=None,theta=None,zz=0,r=0,s=0):

        #get generic cosmology parameters
        k1,k2,k3,theta,Pk1,Pk2,Pk3,f,D1,K,C,b1,xb1,yb1,b2,xb2,yb2,g2,xg2,yg2 = cosmo_funcs.unpack_bk(k1,k2,k3,theta,zz)
        
        ct = np.cos(theta)
        st = np.sin(theta)
        
        return 2*np.sqrt(np.pi)*D1**4*Pk1*Pk2*(3*b1*(-42*ct**6*f**2*k1*k2**3*(C - 1) + 3*ct**5*f**2*k2**2*(5*f*k3**2 - 7*k1**2*(4*C - 5) + 7*k2**2) + ct**4*f*k1*k2*(30*f**2*k3**2 - 21*f*(2*k1**2*(C - 2) + k2**2*(4*C*st**2 - 2*C - 4*st**2 - 2) - k3**2*yb1) - 70*k2**2*xb1*(C - 1) - 35*k3**2*(yb1*(K - 1) - 2*yg2)) + ct**3*f*(15*f**2*k3**2*(k1**2 + 2*k2**2*st**2) + 21*f*(k1**4 + k1**2*(k2**2*(-4*C*st**2 + 4*C + 6*st**2 + 1) + k3**2*yb1) + 2*k2**4*st**2 + k2**2*k3**2*(xb1 + yb1)) + 35*k1**2*(k2**2*xb1*(5 - 4*C) + k3**2*yb1) + 35*k2**4*xb1 + 35*k2**2*k3**2*yb1) + ct**2*k1*k2*(-14*C*f*(f*(k1**2*(st**2 - 3) + 3*k2**2*st**2*(st**2 - 2)) + 5*xb1*(k1**2 + k2**2*(st**2 - 1))) + 36*f**3*k3**2*st**2 + 7*f**2*(8*k1**2*st**2 + 6*k2**2*(st**4 + st**2) + 3*k3**2*(2*st**2*yb1 + 2*xb1 + yb1)) + 35*f*(4*k1**2*xb1 + 2*k2**2*xb1*(st**2 + 1) + k3**2*(yb1*(-K*st**2 + K + st**2 + xb1 + 1) + yb2 + 2*yg2*(st**2 - 1))) - 105*k3**2*xb1*(yb1*(K - 1) - 2*yg2)) + ct*(3*f**3*k3**2*st**2*(3*k1**2 + 5*k2**2*st**2) + 7*f**2*(k1**4*st**2 + k1**2*(k2**2*st**2*(12*C + 3*st**2 + 1) + 3*k3**2*(st**2*yb1 + xb1)) + 3*k2**2*st**2*(k2**2*st**2 + k3**2*(xb1 + yb1))) + 35*f*(k1**4*xb1 + k1**2*(k2**2*xb1*(4*C + st**2 + 1) + k3**2*yb1*(st**2 + xb1)) + k2**4*st**2*xb1 + k2**2*k3**2*yb1*(st**2 + xb1)) + 105*k3**2*xb1*yb1*(k1**2 + k2**2)) + k1*k2*(14*C*f*(f*st**2*(k1**2 + 3*k2**2*st**2) + 5*xb1*(k1**2 + k2**2*st**2)) + k3**2*(6*f**3*st**4 + 7*f**2*st**2*(3*st**2*yb1 + 2*xb1 + yb1) + 35*f*(st**2*(yb1*(K + xb1 + 1) + yb2 - 2*yg2) + xb1*yb1) + 105*xb1*(K*yb1 + yb1 + yb2 - 2*yg2)))) + f*(-90*ct**6*f**2*k1*k2**3*(C - 1) + 5*ct**5*f**2*k2**2*(7*f*k3**2 - 9*k1**2*(4*C - 5) + 9*k2**2) + ct**4*f*k1*k2*(70*f**2*k3**2 + 9*f*(-10*k1**2*(C - 2) - 2*k2**2*(6*C*st**2 - 5*C - 6*st**2 - 5) + 5*k3**2*yb1) - 126*k2**2*xb1*(C - 1) - 63*k3**2*(yb1*(K - 1) - 2*yg2)) + ct**3*f*(5*f**2*k3**2*(7*k1**2 + 10*k2**2*st**2) + 9*f*(5*k1**4 + k1**2*(k2**2*(-12*C*st**2 + 20*C + 18*st**2 + 5) + 5*k3**2*yb1) + 6*k2**4*st**2 + 5*k2**2*k3**2*(xb1 + yb1)) + 63*k1**2*(k2**2*xb1*(5 - 4*C) + k3**2*yb1) + 63*k2**4*xb1 + 63*k2**2*k3**2*yb1) + 3*ct**2*k1*k2*(-2*C*f*(3*f*(k1**2*(st**2 - 5) + k2**2*st**2*(st**2 - 6)) + 7*xb1*(3*k1**2 + k2**2*(st**2 - 3))) + 20*f**3*k3**2*st**2 + 3*f**2*(8*k1**2*st**2 + 2*k2**2*st**2*(st**2 + 3) + k3**2*(6*st**2*yb1 + 10*xb1 + 5*yb1)) + 7*f*(12*k1**2*xb1 + 2*k2**2*xb1*(st**2 + 3) + k3**2*(yb1*(-K*(st**2 - 3) + st**2 + 3*xb1 + 3) + 3*yb2 + 2*yg2*(st**2 - 3))) + 35*k3**2*xb1*(-K*yb1 + yb1 + 2*yg2)) + 3*ct*(5*f**3*k3**2*st**2*(k1**2 + k2**2*st**2) + 3*f**2*(k1**4*st**2 + k1**2*(k2**2*st**2*(12*C + st**2 + 1) + k3**2*(3*st**2*yb1 + 5*xb1)) + k2**4*st**4 + 3*k2**2*k3**2*st**2*(xb1 + yb1)) + 7*f*(3*k1**4*xb1 + k1**2*(k2**2*xb1*(12*C + st**2 + 3) + k3**2*yb1*(st**2 + 3*xb1)) + k2**4*st**2*xb1 + k2**2*k3**2*yb1*(st**2 + 3*xb1)) + 35*k3**2*xb1*yb1*(k1**2 + k2**2)) + 3*k1*k2*(2*C*f*(3*f*st**2*(k1**2 + k2**2*st**2) + 7*xb1*(3*k1**2 + k2**2*st**2)) + k3**2*(2*f**3*st**4 + 3*f**2*st**2*(st**2*yb1 + 2*xb1 + yb1) + 7*f*(st**2*(yb1*(K + xb1 + 1) + yb2 - 2*yg2) + 3*xb1*yb1) + 35*xb1*(K*yb1 + yb1 + yb2 - 2*yg2)))))/(315*k1*k2*k3**2) - 2*np.sqrt(np.pi)*D1**4*Pk1*Pk3*(3*b1*(42*ct**6*f**2*k1*k2**4*(C - 1) + 3*ct**5*f**2*k2**3*(5*f*k2**2 + 7*k1**2*(8*C - 7) + 7*k3**2) + ct**4*f*k1*k2**2*(45*f**2*k2**2 + 21*f*(3*k1**2*(4*C - 3) + k2**2*(4*st**2*(C - 1) - xb1) + k3**2*(3 - 2*C)) + 35*k2**2*(xb1*(K - 1) - 2*xg2) + 70*k3**2*yb1*(C - 1)) + ct**3*f*k2*(15*f**2*(3*k1**2*k2**2 + 2*k2**4*st**2) + 21*f*(k1**4*(8*C - 5) + k1**2*(k2**2*(2*st**2*(6*C - 5) - 3*xb1) + k3**2*(3 - 4*C)) + k2**2*k3**2*(2*st**2 + xb1 + yb1)) + 35*k1**2*(k2**2*(4*K*xb1 - 3*xb1 - 8*xg2) + k3**2*yb1*(4*C - 3)) + 35*k2**2*k3**2*xb1 + 35*k3**4*yb1) + ct**2*k1*(3*f**3*(5*k1**2*k2**2 + 18*k2**4*st**2) + 7*f**2*(k1**4*(6*C - 3) + k1**2*(k2**2*(st**2*(38*C - 26) - 9*xb1) + k3**2*(3 - 6*C)) + 6*k2**4*st**2*(st**2*(C - 1) - xb1) + 3*k2**2*k3**2*(-4*st**2*(C - 1) + 2*xb1 + yb1)) + 35*f*(k1**2*(3*k2**2*(xb1*(2*K - 1) - 4*xg2) + k3**2*yb1*(2*C - 1)) + k2**4*st**2*(xb1*(K - 1) - 2*xg2) - k2**2*k3**2*(-2*st**2*yb1*(C - 1) + xb1*(K + yb1 - 2) + xb2 - 2*xg2) + k3**4*yb1*(1 - 2*C)) + 105*k2**2*k3**2*yb1*(xb1*(K - 1) - 2*xg2)) + ct*k2*(3*f**3*(9*k1**2*k2**2*st**2 + 5*k2**4*st**4) + 7*f**2*(k1**4*(st**2*(16*C - 9) - 3*xb1) + k1**2*(3*k2**2*st**2*(st**2*(4*C - 3) - 3*xb1) + k3**2*(st**2*(7 - 12*C) + 3*xb1)) + 3*k2**2*k3**2*st**2*(st**2 + xb1 + yb1)) + 35*f*(k1**4*(xb1*(4*K - 1) - 8*xg2) - k1**2*(k2**2*st**2*(-2*K*xb1 + xb1 + 4*xg2) + k3**2*(-4*C*st**2*yb1 + 3*st**2*yb1 + xb1*(2*K + yb1 - 1) + 2*xb2 - 4*xg2)) + k2**2*k3**2*st**2*xb1 + k3**4*yb1*(st**2 + xb1)) + 105*k3**2*yb1*(k1**2*(xb1*(2*K - 1) - 4*xg2) + k3**2*xb1)) + k1*(3*f**3*k2**2*st**2*(k1**2 + 3*k2**2*st**2) + 7*f**2*st**2*(k1**4*(2*C - 1) + k1**2*(3*k2**2*(st**2*(2*C - 1) - xb1) + k3**2*(1 - 2*C)) - 3*k2**4*st**2*xb1 + k2**2*k3**2*(st**2*(3 - 6*C) + 2*xb1 + yb1)) + 35*f*(K*xb1*(k1**2 - k3**2)*(k1**2 + k2**2*st**2) - 2*k1**4*xg2 - k1**2*(2*k2**2*st**2*xg2 + k3**2*(st**2*yb1*(1 - 2*C) + xb2 - 2*xg2)) - k3**2*st**2*(k2**2*(xb1*yb1 + xb2 - 2*xg2) + k3**2*yb1*(2*C - 1))) - 105*k3**2*yb1*(K*xb1*(-k1**2 + k3**2) + 2*k1**2*xg2 + k3**2*(xb2 - 2*xg2)))) + f*(90*ct**6*f**2*k1*k2**4*(C - 1) + 5*ct**5*f**2*k2**3*(7*f*k2**2 + 9*k1**2*(8*C - 7) + 9*k3**2) + 3*ct**4*f*k1*k2**2*(35*f**2*k2**2 + 3*f*(15*k1**2*(4*C - 3) + k2**2*(12*st**2*(C - 1) - 5*xb1) - 5*k3**2*(2*C - 3)) + 21*k2**2*(xb1*(K - 1) - 2*xg2) + 42*k3**2*yb1*(C - 1)) + ct**3*f*k2*(5*f**2*(21*k1**2*k2**2 + 10*k2**4*st**2) + 9*f*(5*k1**4*(8*C - 5) + k1**2*(3*k2**2*(2*st**2*(6*C - 5) - 5*xb1) - 5*k3**2*(4*C - 3)) + k2**2*k3**2*(6*st**2 + 5*xb1 + 5*yb1)) + 63*k1**2*(k2**2*(4*K*xb1 - 3*xb1 - 8*xg2) + k3**2*yb1*(4*C - 3)) + 63*k2**2*k3**2*xb1 + 63*k3**4*yb1) + ct**2*k1*(5*f**3*(7*k1**2*k2**2 + 18*k2**4*st**2) + 9*f**2*(5*k1**4*(2*C - 1) + k1**2*(k2**2*(st**2*(38*C - 26) - 15*xb1) + k3**2*(5 - 10*C)) + 2*k2**4*st**2*(st**2*(C - 1) - 3*xb1) + k2**2*k3**2*(-12*st**2*(C - 1) + 10*xb1 + 5*yb1)) + 21*f*(3*k1**2*(3*k2**2*(2*K*xb1 - xb1 - 4*xg2) + k3**2*yb1*(2*C - 1)) + k2**4*st**2*(xb1*(K - 1) - 2*xg2) + k2**2*k3**2*(2*C*st**2*yb1 - 2*st**2*yb1 - 3*xb1*(K + yb1 - 2) - 3*xb2 + 6*xg2) + 3*k3**4*yb1*(1 - 2*C)) + 105*k2**2*k3**2*yb1*(xb1*(K - 1) - 2*xg2)) + 3*ct*k2*(5*f**3*(3*k1**2*k2**2*st**2 + k2**4*st**4) + 3*f**2*(k1**4*(st**2*(16*C - 9) - 5*xb1) + k1**2*(k2**2*st**2*(st**2*(4*C - 3) - 9*xb1) + k3**2*(st**2*(7 - 12*C) + 5*xb1)) + k2**2*k3**2*st**2*(st**2 + 3*xb1 + 3*yb1)) + 7*f*(3*k1**4*(xb1*(4*K - 1) - 8*xg2) - k1**2*(k2**2*st**2*(-2*K*xb1 + xb1 + 4*xg2) + k3**2*(-4*C*st**2*yb1 + 3*st**2*yb1 + 3*xb1*(2*K + yb1 - 1) + 6*xb2 - 12*xg2)) + k2**2*k3**2*st**2*xb1 + k3**4*yb1*(st**2 + 3*xb1)) + 35*k3**2*yb1*(k1**2*(xb1*(2*K - 1) - 4*xg2) + k3**2*xb1)) + k1*(f**3*(5*k1**2*k2**2*st**2 + 9*k2**4*st**4) + 9*f**2*st**2*(k1**4*(2*C - 1) + k1**2*(k2**2*(st**2*(2*C - 1) - 3*xb1) + k3**2*(1 - 2*C)) - k2**4*st**2*xb1 + k2**2*k3**2*(-2*C*st**2 + st**2 + 2*xb1 + yb1)) + 21*f*(K*xb1*(k1**2 - k3**2)*(3*k1**2 + k2**2*st**2) - 6*k1**4*xg2 - k1**2*(2*k2**2*st**2*xg2 + k3**2*(st**2*yb1*(1 - 2*C) + 3*xb2 - 6*xg2)) - k3**2*st**2*(k2**2*(xb1*yb1 + xb2 - 2*xg2) + k3**2*yb1*(2*C - 1))) - 105*k3**2*yb1*(K*xb1*(-k1**2 + k3**2) + 2*k1**2*xg2 + k3**2*(xb2 - 2*xg2)))))/(315*k1*k3**4) - 2*np.sqrt(np.pi)*D1**4*Pk2*Pk3*(ct**6*f**2*k1**2*k2**3*(63*b1*(K - 1) + 35*f**2 + 90*f*(C - 1) - 126*g2) - 3*ct**5*f**2*k1*k2**2*(-3*b1*(14*k1**2*(K - 1) + k2**2*(14*K - 5*f - 7) + k3**2*(5*f + 7)) - 35*f**2*k1**2 - 15*f*(4*k1**2*(C - 1) + k2**2*(4*C - 3) + k3**2) + 84*g2*(k1**2 + k2**2)) - 3*ct**4*f*k2*(b1*(15*f**2*k1**2*(3*k2**2 - 2*k3**2) - 21*f*(K*k2**2*(k2**2 - k3**2) + k1**4*(K - 1) + 2*k1**2*(k2**2*(K*(st**2 + 2) - st**2 - 1) + k3**2)) - 35*k1**2*(K - 1)*(k2**2*xb1 + k3**2*yb1)) - 5*f**3*(7*k1**4 + 5*k1**2*k2**2*st**2) - 3*f**2*(10*k1**4*(C - 1) + k1**2*(k2**2*(12*C*st**2 + 40*C - 12*st**2 + 5*xb1 - 30) + 5*k3**2*(yb1 + 2)) + 5*k2**2*(2*C - 1)*(k2**2 - k3**2)) + 21*f*(b2*k2**2*k3**2 + 2*g2*(k1**4 + 2*k1**2*k2**2*(st**2 + 2) + k2**4 - k2**2*k3**2) - 2*k1**2*(C - 1)*(k2**2*xb1 + k3**2*yb1)) + 70*g2*k1**2*(k2**2*xb1 + k3**2*yb1)) + ct**3*f*k1*(210*b1*k1**2*k2**2*xb1*(K - 1) + 105*b1*(k2**2*xb1 + k3**2*yb1)*(k2**2*(2*K - 1) + k3**2) + 5*f**3*(7*k1**4 + 30*k1**2*k2**2*st**2) - 9*f**2*(k1**2*(k2**2*(-4*C*(3*st**2 + 5) + 15*b1 + 12*st**2 - 15*xb1 + 15) - 5*k3**2*(b1 + yb1 + 1)) - 2*k2**2*(k2**2*(2*C*(6*st**2 + 5) - st**2*(5*b1 + 9) - 5) + k3**2*(-10*C + st**2*(5*b1 + 3) + 5))) + 63*f*(4*C*k1**2*k2**2*xb1 + 4*C*k2**4*xb1 + 4*C*k2**2*k3**2*yb1 + b1*(2*K*(k2**4*(2*st**2 + 1) - k2**2*k3**2) + k1**2*(k2**2*(2*K*(st**2 + 1) - 2*st**2 - 1) + k3**2) - (k2**2 - k3**2)*(k2**2*(2*st**2 + xb1) + k3**2*yb1)) - 2*b2*k2**2*k3**2 - 4*g2*k1**2*k2**2*st**2 - 4*g2*k1**2*k2**2 - 8*g2*k2**4*st**2 - 4*g2*k2**4 + 4*g2*k2**2*k3**2 - 4*k1**2*k2**2*xb1 - 3*k2**4*xb1 + k2**2*k3**2*xb1 - 3*k2**2*k3**2*yb1 + k3**4*yb1) - 420*g2*k2**2*(k1**2*xb1 + k2**2*xb1 + k3**2*yb1)) - 3*ct**2*k2*(b1*(3*f**3*k1**2*(5*k1**2 + 6*st**2*(3*k2**2 - 2*k3**2)) - 7*f**2*(K*(k1**4*st**2 + 3*k1**2*(k2**2*(st**4 + 4*st**2 + 1) - k3**2) + 6*k2**2*st**2*(k2**2 - k3**2)) - k1**2*(k1**2*st**2 + 3*k2**2*(st**4 + 2*st**2 + 3*xb1) + 3*k3**2*(-2*st**2 - 2*xb1 + yb1))) - 35*f*(K*(k2**2 - k3**2)*(k2**2*xb1 + k3**2*yb1) + k1**4*xb1*(K - 1) + k1**2*(k2**2*xb1*(K*(st**2 + 4) - st**2 - 2) + k3**2*(st**2*yb1*(K - 1) + 2*xb1))) - 105*k1**2*k3**2*xb1*yb1*(K - 1)) - 15*f**4*(2*k1**4*st**2 + k1**2*k2**2*st**4) - 3*f**3*(k1**4*(2*st**2*(C - 1) + 15*xb1) + k1**2*(k2**2*(2*C*(st**4 + 12*st**2 + 5) - 2*st**4 + 6*st**2*(xb1 - 3) - 5) + k3**2*(-10*C + 6*st**2*(yb1 + 1) + 5)) + 6*k2**2*st**2*(2*C - 1)*(k2**2 - k3**2)) + 7*f**2*(-6*C*k1**4*xb1 - 2*C*k1**2*k2**2*st**2*xb1 - 24*C*k1**2*k2**2*xb1 - 2*C*k1**2*k3**2*st**2*yb1 - 6*C*k2**4*xb1 + 6*C*k2**2*k3**2*xb1 - 6*C*k2**2*k3**2*yb1 + 6*C*k3**4*yb1 + 3*b2*k3**2*(k1**2 + 2*k2**2*st**2) + 2*g2*(k1**4*st**2 + 3*k1**2*(k2**2*(st**4 + 4*st**2 + 1) - k3**2) + 6*k2**2*st**2*(k2**2 - k3**2)) + 6*k1**4*xb1 + 2*k1**2*k2**2*st**2*xb1 + 18*k1**2*k2**2*xb1 + 2*k1**2*k3**2*st**2*yb1 - 3*k1**2*k3**2*xb1*yb1 - 6*k1**2*k3**2*xb1 + 3*k2**4*xb1 - 3*k2**2*k3**2*xb1 + 3*k2**2*k3**2*yb1 - 3*k3**4*yb1) + 35*f*(2*g2*(k1**4*xb1 + k1**2*(k2**2*xb1*(st**2 + 4) + k3**2*st**2*yb1) + (k2**2 - k3**2)*(k2**2*xb1 + k3**2*yb1)) + k3**2*(b2*(k2**2*xb1 + k3**2*yb1) - 2*k1**2*xb1*yb1*(C - 1))) + 210*g2*k1**2*k3**2*xb1*yb1) + 3*ct*k1*(5*f**4*k1**2*st**2*(k1**2 + 3*k2**2*st**2) + 3*f**3*(5*k1**4*xb1 + k1**2*st**2*(k2**2*(4*C - 9*b1 + 9*xb1 - 3) + k3**2*(3*b1 + 3*yb1 + 1)) + k2**2*st**2*(k2**2*(4*C*(st**2 + 3) - st**2*(5*b1 + 3) - 6) + k3**2*(-12*C + st**2*(5*b1 + 1) + 6))) + 7*f**2*(12*C*k1**2*k2**2*xb1 + 4*C*k2**4*st**2*xb1 + 12*C*k2**4*xb1 + 4*C*k2**2*k3**2*st**2*yb1 - 12*C*k2**2*k3**2*xb1 + b1*k1**2*(k2**2*(st**2*(2*K - 1) - 9*xb1) + k3**2*(st**2 + 3*xb1)) + 3*b1*st**2*(2*K*(k2**4*(st**2 + 1) - k2**2*k3**2) - (k2**2 - k3**2)*(k2**2*(st**2 + xb1) + k3**2*yb1)) - 6*b2*k2**2*k3**2*st**2 - 4*g2*k2**2*st**2*(k1**2 + 3*k2**2*(st**2 + 1) - 3*k3**2) - 9*k1**2*k2**2*xb1 + 3*k1**2*k3**2*xb1*yb1 + 3*k1**2*k3**2*xb1 - 3*k2**4*st**2*xb1 - 6*k2**4*xb1 + k2**2*k3**2*st**2*xb1 - 3*k2**2*k3**2*st**2*yb1 + 6*k2**2*k3**2*xb1 + k3**4*st**2*yb1) + 35*f*(4*C*k2**2*k3**2*xb1*yb1 + b1*(2*K*k2**2*(k2**2*xb1*(st**2 + 1) + k3**2*(st**2*yb1 - xb1)) + k1**2*xb1*(k2**2*(2*K - 1) + k3**2) - (k2**2 - k3**2)*(k2**2*st**2*xb1 + k3**2*yb1*(st**2 + xb1))) - 2*b2*k2**2*k3**2*xb1 - 4*g2*k1**2*k2**2*xb1 - 4*g2*k2**4*st**2*xb1 - 4*g2*k2**4*xb1 - 4*g2*k2**2*k3**2*st**2*yb1 + 4*g2*k2**2*k3**2*xb1 - 3*k2**2*k3**2*xb1*yb1 + k3**4*xb1*yb1) + 105*k3**2*xb1*yb1*(b1*(k2**2*(2*K - 1) + k3**2) - 4*g2*k2**2)) + k2*(-3*b1*(105*K*k3**2*xb1*yb1*(-k2**2 + k3**2) + 3*f**3*k1**2*st**2*(k1**2 + st**2*(3*k2**2 - 2*k3**2)) - 7*f**2*(K*st**2*(k1**2 + 3*k2**2*st**2)*(k2**2 - k3**2) - 3*k1**4*xb1 - k1**2*st**2*(3*k2**2*xb1 + k3**2*(-2*xb1 + yb1))) - 35*f*(K*(k2**2 - k3**2)*(k1**2*xb1 + st**2*(k2**2*xb1 + k3**2*yb1)) - k1**2*k3**2*xb1*yb1)) + f**4*(9*k1**4*st**4 + 5*k1**2*k2**2*st**6) + 9*f**3*st**2*(3*k1**4*xb1 + k1**2*(k2**2*(2*C + st**2*xb1 - 1) + k3**2*(-2*C + st**2*yb1 + 1)) + k2**2*st**2*(2*C - 1)*(k2**2 - k3**2)) - 21*f**2*(-6*C*k1**2*k2**2*xb1 + 6*C*k1**2*k3**2*xb1 - 2*C*k2**4*st**2*xb1 + 2*C*k2**2*k3**2*st**2*xb1 - 2*C*k2**2*k3**2*st**2*yb1 + 2*C*k3**4*st**2*yb1 + b2*k3**2*st**2*(k1**2 + 3*k2**2*st**2) + 2*g2*st**2*(k1**2 + 3*k2**2*st**2)*(k2**2 - k3**2) + 3*k1**2*k2**2*xb1 - k1**2*k3**2*st**2*xb1*yb1 - 3*k1**2*k3**2*xb1 + k2**4*st**2*xb1 - k2**2*k3**2*st**2*xb1 + k2**2*k3**2*st**2*yb1 - k3**4*st**2*yb1) - 105*f*(2*g2*(k2**2 - k3**2)*(k1**2*xb1 + st**2*(k2**2*xb1 + k3**2*yb1)) + k3**2*(b2*k1**2*xb1 + b2*st**2*(k2**2*xb1 + k3**2*yb1) - xb1*yb1*(2*C - 1)*(k2**2 - k3**2))) - 315*k3**2*xb1*yb1*(b2*k3**2 + 2*g2*(k2**2 - k3**2))))/(315*k2*k3**4)
    
    @staticmethod
    def l2(cosmo_funcs,k1,k2,k3=None,theta=None,zz=0,r=0,s=0):
        
        #get generic cosmology parameters
        k1,k2,k3,theta,Pk1,Pk2,Pk3,f,D1,K,C,b1,xb1,yb1,b2,xb2,yb2,g2,xg2,yg2 = cosmo_funcs.unpack_bk(k1,k2,k3,theta,zz)
        
        ct = np.cos(theta)
        st = np.sin(theta)
        
        return 2*np.sqrt(5)*np.sqrt(np.pi)*D1**4*Pk1*Pk2*f*(-33*b1*(24*ct**6*f*k1*k2**3*(C - 1) - 2*ct**5*f*k2**2*(5*f*k3**2 - 6*k1**2*(4*C - 5) + 6*k2**2) - 2*ct**4*k1*k2*(10*f**2*k3**2 - 6*f*(2*k1**2*(C - 2) + k2**2*(C*(st**2 - 2) - st**2 - 2) - k3**2*yb1) - 14*k2**2*xb1*(C - 1) + 7*k3**2*(-K*yb1 + yb1 + 2*yg2)) - 2*ct**3*(5*f**2*k3**2*(k1**2 + k2**2*st**2) + 3*f*(2*k1**4 + k1**2*(k2**2*(-2*C*st**2 + 8*C + 3*st**2 + 2) + 2*k3**2*yb1) + k2**4*st**2 + 2*k2**2*k3**2*(xb1 + yb1)) + 7*k1**2*(k2**2*xb1*(5 - 4*C) + k3**2*yb1) + 7*k2**4*xb1 + 7*k2**2*k3**2*yb1) + ct**2*k1*k2*(2*C*(f*k1**2*(st**2 - 12) - 6*f*k2**2*st**2*(st**2 + 1) + 14*k1**2*xb1 - 7*k2**2*xb1*(st**2 + 2)) - 12*f**2*k3**2*st**2 - 2*f*(4*k1**2*st**2 + 3*k2**2*(-2*st**4 + st**2) + 3*k3**2*(4*xb1 + yb1*(st**2 + 2))) - 56*k1**2*xb1 + 14*k2**2*xb1*(st**2 - 2) - 7*k3**2*(yb1*(K*(st**2 + 2) - st**2 + 2*xb1 + 2) + 2*yb2 - 2*yg2*(st**2 + 2))) - ct*(3*f**2*k1**2*k3**2*st**2 + f*(k1**4*st**2 + k1**2*(k2**2*st**2*(12*C - 6*st**2 + 1) + 3*k3**2*(st**2*yb1 + 4*xb1)) - 6*k2**4*st**4 + 3*k2**2*k3**2*st**2*(xb1 + yb1)) + 14*k1**4*xb1 + 7*k1**2*(k2**2*xb1*(8*C - st**2 + 2) - k3**2*yb1*(st**2 - 2*xb1)) - 7*k2**2*(k2**2*st**2*xb1 + k3**2*yb1*(st**2 - 2*xb1))) + k1*k2*(-2*C*(f*k1**2*st**2 - 6*f*k2**2*st**4 + 14*k1**2*xb1 - 7*k2**2*st**2*xb1) + k3**2*(f*st**2*(-2*xb1 + yb1*(6*st**2 - 1)) + 7*st**2*(yb1*(K + xb1 + 1) + yb2 - 2*yg2) - 14*xb1*yb1))) - 660*ct**6*f**2*k1*k2**3*(C - 1) + 10*ct**5*f**2*k2**2*(28*f*k3**2 - 33*k1**2*(4*C - 5) + 33*k2**2) + 2*ct**4*f*k1*k2*(280*f**2*k3**2 - 33*f*(10*k1**2*(C - 2) + 2*k2**2*(3*C*st**2 - 5*C - 3*st**2 - 5) - 5*k3**2*yb1) - 396*k2**2*xb1*(C - 1) - 198*k3**2*(yb1*(K - 1) - 2*yg2)) + 2*ct**3*f*(5*f**2*k3**2*(28*k1**2 + 25*k2**2*st**2) + 33*f*(5*k1**4 + k1**2*(k2**2*(-6*C*st**2 + 20*C + 9*st**2 + 5) + 5*k3**2*yb1) + 3*k2**4*st**2 + 5*k2**2*k3**2*(xb1 + yb1)) - 198*k1**2*(k2**2*xb1*(4*C - 5) - k3**2*yb1) + 198*k2**2*(k2**2*xb1 + k3**2*yb1)) + 3*ct**2*k1*k2*(-22*C*f*(f*k1**2*(st**2 - 10) - 6*f*k2**2*st**2 + 12*k1**2*xb1 + k2**2*xb1*(st**2 - 12)) + 100*f**3*k3**2*st**2 + 22*f**2*(4*k1**2*st**2 + 3*k2**2*st**2 + k3**2*(3*st**2*yb1 + 10*xb1 + 5*yb1)) + 11*f*(48*k1**2*xb1 + 2*k2**2*xb1*(st**2 + 12) + k3**2*(yb1*(-K*(st**2 - 12) + st**2 + 12*xb1 + 12) + 12*yb2 + 2*yg2*(st**2 - 12))) - 154*k3**2*xb1*(yb1*(K - 1) - 2*yg2)) + 3*ct*(5*f**3*k3**2*st**2*(5*k1**2 + 2*k2**2*st**2) + 11*f**2*(k1**4*st**2 + k1**2*(k2**2*st**2*(12*C + 1) + k3**2*(3*st**2*yb1 + 10*xb1)) + 3*k2**2*k3**2*st**2*(xb1 + yb1)) + 11*f*(12*k1**4*xb1 + k1**2*(k2**2*xb1*(48*C + st**2 + 12) + k3**2*yb1*(st**2 + 12*xb1)) + k2**4*st**2*xb1 + k2**2*k3**2*yb1*(st**2 + 12*xb1)) + 154*k3**2*xb1*yb1*(k1**2 + k2**2)) + 3*k1*k2*(22*C*f*(f*k1**2*st**2 + 12*k1**2*xb1 + k2**2*st**2*xb1) + k3**2*(4*f**3*st**4 + 11*f**2*st**2*(2*xb1 + yb1) + 11*f*(st**2*(yb1*(K + xb1 + 1) + yb2 - 2*yg2) + 12*xb1*yb1) + 154*xb1*(K*yb1 + yb1 + yb2 - 2*yg2))))/(3465*k1*k2*k3**2) - 2*np.sqrt(5)*np.sqrt(np.pi)*D1**4*Pk1*Pk3*f*(33*b1*(24*ct**6*f*k1*k2**4*(C - 1) + 2*ct**5*f*k2**3*(5*f*k2**2 + 6*k1**2*(8*C - 7) + 6*k3**2) + 2*ct**4*k1*k2**2*(15*f**2*k2**2 + 6*f*(3*k1**2*(4*C - 3) + k2**2*(st**2*(C - 1) - xb1) + k3**2*(3 - 2*C)) + 7*k2**2*(xb1*(K - 1) - 2*xg2) + 14*k3**2*yb1*(C - 1)) + 2*ct**3*k2*(5*f**2*(3*k1**2*k2**2 + k2**4*st**2) + 3*f*(2*k1**4*(8*C - 5) + k1**2*(k2**2*(st**2*(6*C - 5) - 6*xb1) + k3**2*(6 - 8*C)) + k2**2*k3**2*(st**2 + 2*xb1 + 2*yb1)) + 7*k1**2*(k2**2*(4*K*xb1 - 3*xb1 - 8*xg2) + k3**2*yb1*(4*C - 3)) + 7*k2**2*k3**2*xb1 + 7*k3**4*yb1) + ct**2*k1*(2*f**2*(5*k1**2*k2**2 + 9*k2**4*st**2) + 2*f*(6*k1**4*(2*C - 1) + k1**2*(k2**2*(st**2*(19*C - 13) - 18*xb1) + k3**2*(6 - 12*C)) - 3*k2**4*st**2*(2*st**2*(C - 1) + xb1) + 6*k2**2*k3**2*(-st**2*(C - 1) + 2*xb1 + yb1)) + 14*k1**2*(3*k2**2*(2*K*xb1 - xb1 - 4*xg2) + k3**2*yb1*(2*C - 1)) + 7*k2**4*st**2*(-K*xb1 + xb1 + 2*xg2) - 14*k2**2*k3**2*(C*st**2*yb1 - st**2*yb1 + xb1*(K + yb1 - 2) + xb2 - 2*xg2) + 14*k3**4*yb1*(1 - 2*C)) + ct*k2*(9*f**2*k1**2*k2**2*st**2 + f*(k1**4*(st**2*(16*C - 9) - 12*xb1) + k1**2*(-3*k2**2*st**2*(st**2*(8*C - 6) + 3*xb1) + k3**2*(st**2*(7 - 12*C) + 12*xb1)) + 3*k2**2*k3**2*st**2*(-2*st**2 + xb1 + yb1)) - 14*k1**4*(-4*K*xb1 + xb1 + 8*xg2) - 7*k1**2*(k2**2*st**2*(xb1*(2*K - 1) - 4*xg2) + k3**2*(4*C*st**2*yb1 - 3*st**2*yb1 + 2*xb1*(2*K + yb1 - 1) + 4*xb2 - 8*xg2)) - 7*k2**2*k3**2*st**2*xb1 - 7*k3**4*yb1*(st**2 - 2*xb1)) + k1*(7*K*xb1*(k1**2 - k3**2)*(2*k1**2 - k2**2*st**2) + f**2*k1**2*k2**2*st**2 + f*st**2*(k1**4*(2*C - 1) + k1**2*(-3*k2**2*(st**2*(4*C - 2) + xb1) + k3**2*(1 - 2*C)) + 6*k2**4*st**2*xb1 + k2**2*k3**2*(6*st**2*(2*C - 1) + 2*xb1 + yb1)) - 28*k1**4*xg2 + 7*k1**2*(2*k2**2*st**2*xg2 + k3**2*(st**2*yb1*(1 - 2*C) - 2*xb2 + 4*xg2)) + 7*k3**2*st**2*(k2**2*(xb1*yb1 + xb2 - 2*xg2) + k3**2*yb1*(2*C - 1)))) + 660*ct**6*f**2*k1*k2**4*(C - 1) + 10*ct**5*f**2*k2**3*(28*f*k2**2 + 33*k1**2*(8*C - 7) + 33*k3**2) + 6*ct**4*f*k1*k2**2*(140*f**2*k2**2 + 11*f*(15*k1**2*(4*C - 3) + k2**2*(6*st**2*(C - 1) - 5*xb1) - 5*k3**2*(2*C - 3)) + 66*k2**2*(xb1*(K - 1) - 2*xg2) + 132*k3**2*yb1*(C - 1)) + 2*ct**3*f*k2*(5*f**2*(84*k1**2*k2**2 + 25*k2**4*st**2) + 33*f*(5*k1**4*(8*C - 5) + k1**2*(3*k2**2*(st**2*(6*C - 5) - 5*xb1) - 5*k3**2*(4*C - 3)) + k2**2*k3**2*(3*st**2 + 5*xb1 + 5*yb1)) + 198*k1**2*(k2**2*(4*K*xb1 - 3*xb1 - 8*xg2) + k3**2*yb1*(4*C - 3)) + 198*k2**2*k3**2*xb1 + 198*k3**4*yb1) + ct**2*k1*(10*f**3*(28*k1**2*k2**2 + 45*k2**4*st**2) + 66*f**2*(5*k1**4*(2*C - 1) + k1**2*(k2**2*(st**2*(19*C - 13) - 15*xb1) + k3**2*(5 - 10*C)) - 3*k2**4*st**2*xb1 + k2**2*k3**2*(-6*st**2*(C - 1) + 10*xb1 + 5*yb1)) + 33*f*(12*k1**2*(3*k2**2*(2*K*xb1 - xb1 - 4*xg2) + k3**2*yb1*(2*C - 1)) + k2**4*st**2*(xb1*(K - 1) - 2*xg2) - 2*k2**2*k3**2*(-C*st**2*yb1 + st**2*yb1 + 6*xb1*(K + yb1 - 2) + 6*xb2 - 12*xg2) + 12*k3**4*yb1*(1 - 2*C)) + 462*k2**2*k3**2*yb1*(xb1*(K - 1) - 2*xg2)) + 3*ct*k2*(5*f**3*(15*k1**2*k2**2*st**2 + 2*k2**4*st**4) + 11*f**2*(k1**4*(st**2*(16*C - 9) - 10*xb1) + k1**2*(-9*k2**2*st**2*xb1 + k3**2*(st**2*(7 - 12*C) + 10*xb1)) + 3*k2**2*k3**2*st**2*(xb1 + yb1)) + 11*f*(12*k1**4*(xb1*(4*K - 1) - 8*xg2) - k1**2*(k2**2*st**2*(-2*K*xb1 + xb1 + 4*xg2) + k3**2*(-4*C*st**2*yb1 + 3*st**2*yb1 + 12*xb1*(2*K + yb1 - 1) + 24*xb2 - 48*xg2)) + k2**2*k3**2*st**2*xb1 + k3**4*yb1*(st**2 + 12*xb1)) + 154*k3**2*yb1*(k1**2*(xb1*(2*K - 1) - 4*xg2) + k3**2*xb1)) + k1*(f**3*(25*k1**2*k2**2*st**2 + 18*k2**4*st**4) + 33*f**2*st**2*(k1**4*(2*C - 1) + k1**2*(-3*k2**2*xb1 + k3**2*(1 - 2*C)) + k2**2*k3**2*(2*xb1 + yb1)) + 33*f*(K*xb1*(k1**2 - k3**2)*(12*k1**2 + k2**2*st**2) - 24*k1**4*xg2 - k1**2*(2*k2**2*st**2*xg2 + k3**2*(st**2*yb1*(1 - 2*C) + 12*xb2 - 24*xg2)) - k3**2*st**2*(k2**2*(xb1*yb1 + xb2 - 2*xg2) + k3**2*yb1*(2*C - 1))) - 462*k3**2*yb1*(K*xb1*(-k1**2 + k3**2) + 2*k1**2*xg2 + k3**2*(xb2 - 2*xg2))))/(3465*k1*k3**4) - 2*np.sqrt(5)*np.sqrt(np.pi)*D1**4*Pk2*Pk3*f*(4*ct**6*f*k1**2*k2**3*(99*b1*(K - 1) + 70*f**2 + 165*f*(C - 1) - 198*g2) - 6*ct**5*f*k1*k2**2*(-11*b1*(12*k1**2*(K - 1) + k2**2*(12*K - 5*f - 6) + k3**2*(5*f + 6)) - 140*f**2*k1**2 - 55*f*(4*k1**2*(C - 1) + k2**2*(4*C - 3) + k3**2) + 264*g2*(k1**2 + k2**2)) - 3*ct**4*k2*(22*b1*(5*f**2*k1**2*(3*k2**2 - 2*k3**2) - 3*f*(2*K*k2**2*(k2**2 - k3**2) + 2*k1**4*(K - 1) + k1**2*(k2**2*(K*(st**2 + 8) - st**2 - 4) + 4*k3**2)) - 7*k1**2*(K - 1)*(k2**2*xb1 + k3**2*yb1)) - 5*f**3*(56*k1**4 + 25*k1**2*k2**2*st**2) - 22*f**2*(10*k1**4*(C - 1) + k1**2*(k2**2*(6*C*st**2 + 40*C - 6*st**2 + 5*xb1 - 30) + 5*k3**2*(yb1 + 2)) + 5*k2**2*(2*C - 1)*(k2**2 - k3**2)) + 132*f*(b2*k2**2*k3**2 + g2*(2*k1**4 + k1**2*k2**2*(st**2 + 8) + 2*k2**2*(k2**2 - k3**2)) - 2*k1**2*(C - 1)*(k2**2*xb1 + k3**2*yb1)) + 308*g2*k1**2*(k2**2*xb1 + k3**2*yb1)) + 2*ct**3*k1*(462*b1*k1**2*k2**2*xb1*(K - 1) + 231*b1*(k2**2*xb1 + k3**2*yb1)*(k2**2*(2*K - 1) + k3**2) + 5*f**3*(28*k1**4 + 75*k1**2*k2**2*st**2) - 33*f**2*(k1**2*(k2**2*(-6*C*st**2 - 20*C + 15*b1 + 6*st**2 - 15*xb1 + 15) - 5*k3**2*(b1 + yb1 + 1)) + k2**4*(-4*C*(3*st**2 + 5) + st**2*(5*b1 + 9) + 10) + k2**2*k3**2*(20*C - st**2*(5*b1 + 3) - 10)) + 99*f*(8*C*k1**2*k2**2*xb1 + 8*C*k2**4*xb1 + 8*C*k2**2*k3**2*yb1 + b1*(2*K*(k2**4*(st**2 + 2) - 2*k2**2*k3**2) + k1**2*(k2**2*(K*(st**2 + 4) - st**2 - 2) + 2*k3**2) - (k2**2 - k3**2)*(k2**2*(st**2 + 2*xb1) + 2*k3**2*yb1)) - 4*b2*k2**2*k3**2 - 2*g2*k2**2*(k1**2*(st**2 + 4) + 2*k2**2*(st**2 + 2) - 4*k3**2) - 8*k1**2*k2**2*xb1 - 6*k2**4*xb1 + 2*k2**2*k3**2*xb1 - 6*k2**2*k3**2*yb1 + 2*k3**4*yb1) - 924*g2*k2**2*(k1**2*xb1 + k2**2*xb1 + k3**2*yb1)) + 3*ct**2*k2*(-11*b1*(-14*K*(k2**2 - k3**2)*(k2**2*xb1 + k3**2*yb1) + 2*f**2*(5*k1**4 + 3*k1**2*st**2*(3*k2**2 - 2*k3**2)) + f*(-K*(k1**4*st**2 - 6*k1**2*(k2**2*(st**4 - 2*st**2 - 2) + 2*k3**2) + 6*k2**2*st**2*(k2**2 - k3**2)) + k1**4*st**2 - 6*k1**2*(k2**2*(st**4 - st**2 - 6*xb1) + k3**2*(st**2 + 4*xb1 - 2*yb1))) - 14*k1**4*xb1*(K - 1) - 7*k1**2*(k2**2*xb1*(-K*(st**2 - 8) + st**2 - 4) + k3**2*(-st**2*yb1*(K - 1) + 4*xb1))) + 30*f**3*(5*k1**4*st**2 + k1**2*k2**2*st**4) + 22*f**2*(k1**4*(st**2*(C - 1) + 15*xb1) + k1**2*(k2**2*(2*C*(6*st**2 + 5) + 3*st**2*(xb1 - 3) - 5) + k3**2*(-10*C + 3*st**2*(yb1 + 1) + 5)) + 3*k2**2*st**2*(2*C - 1)*(k2**2 - k3**2)) - 22*f*(-12*C*k1**4*xb1 - C*k1**2*k2**2*st**2*xb1 - 48*C*k1**2*k2**2*xb1 - C*k1**2*k3**2*st**2*yb1 - 12*C*k2**4*xb1 + 12*C*k2**2*k3**2*xb1 - 12*C*k2**2*k3**2*yb1 + 12*C*k3**4*yb1 + 3*b2*k3**2*(2*k1**2 + k2**2*st**2) + g2*(k1**4*st**2 - 6*k1**2*(k2**2*(st**4 - 2*st**2 - 2) + 2*k3**2) + 6*k2**2*st**2*(k2**2 - k3**2)) + 12*k1**4*xb1 + k1**2*k2**2*st**2*xb1 + 36*k1**2*k2**2*xb1 + k1**2*k3**2*st**2*yb1 - 6*k1**2*k3**2*xb1*yb1 - 12*k1**2*k3**2*xb1 + 6*k2**4*xb1 - 6*k2**2*k3**2*xb1 + 6*k2**2*k3**2*yb1 - 6*k3**4*yb1) - 154*g2*(2*k1**4*xb1 - k1**2*(k2**2*xb1*(st**2 - 8) + k3**2*st**2*yb1) + 2*(k2**2 - k3**2)*(k2**2*xb1 + k3**2*yb1)) - 154*k3**2*(b2*(k2**2*xb1 + k3**2*yb1) - 2*k1**2*xb1*yb1*(C - 1))) + 3*ct*k1*(616*C*k2**2*k3**2*xb1*yb1 + 77*b1*(-2*K*k2**2*(k2**2*xb1*(st**2 - 2) + k3**2*(st**2*yb1 + 2*xb1)) + 2*k1**2*xb1*(k2**2*(2*K - 1) + k3**2) + (k2**2 - k3**2)*(k2**2*st**2*xb1 + k3**2*yb1*(st**2 - 2*xb1))) - 308*b2*k2**2*k3**2*xb1 + 5*f**3*(5*k1**4*st**2 + 6*k1**2*k2**2*st**4) + 11*f**2*(10*k1**4*xb1 + k1**2*st**2*(k2**2*(4*C - 9*b1 + 9*xb1 - 3) + k3**2*(3*b1 + 3*yb1 + 1)) + 6*k2**2*st**2*(2*C - 1)*(k2**2 - k3**2)) + 11*f*(48*C*k1**2*k2**2*xb1 + 4*C*k2**4*st**2*xb1 + 48*C*k2**4*xb1 + 4*C*k2**2*k3**2*st**2*yb1 - 48*C*k2**2*k3**2*xb1 + b1*k1**2*(k2**2*(st**2*(2*K - 1) - 36*xb1) + k3**2*(st**2 + 12*xb1)) - 3*b1*st**2*(2*K*k2**2*(k2**2*(2*st**2 - 1) + k3**2) - (k2**2 - k3**2)*(k2**2*(2*st**2 - xb1) - k3**2*yb1)) - 6*b2*k2**2*k3**2*st**2 - 4*g2*k2**2*st**2*(k1**2 - 3*k2**2*(2*st**2 - 1) - 3*k3**2) - 36*k1**2*k2**2*xb1 + 12*k1**2*k3**2*xb1*yb1 + 12*k1**2*k3**2*xb1 - 3*k2**4*st**2*xb1 - 24*k2**4*xb1 + k2**2*k3**2*st**2*xb1 - 3*k2**2*k3**2*st**2*yb1 + 24*k2**2*k3**2*xb1 + k3**4*st**2*yb1) - 616*g2*k1**2*k2**2*xb1 + 308*g2*k2**4*st**2*xb1 - 616*g2*k2**4*xb1 + 308*g2*k2**2*k3**2*st**2*yb1 + 616*g2*k2**2*k3**2*xb1 - 462*k2**2*k3**2*xb1*yb1 + 154*k3**4*xb1*yb1) + k2*(-33*b1*(7*K*(k2**2 - k3**2)*(-2*k1**2*xb1 + st**2*(k2**2*xb1 + k3**2*yb1)) + f**2*k1**4*st**2 + f*(K*st**2*(-k1**2 + 6*k2**2*st**2)*(k2**2 - k3**2) + 12*k1**4*xb1 + k1**2*st**2*(3*k2**2*xb1 + k3**2*(-2*xb1 + yb1))) + 14*k1**2*k3**2*xb1*yb1) + f**3*(18*k1**4*st**4 - 5*k1**2*k2**2*st**6) + 33*f**2*k1**2*st**2*(3*k1**2*xb1 + k2**2*(2*C - 1) + k3**2*(1 - 2*C)) - 33*f*(-24*C*k1**2*k2**2*xb1 + 24*C*k1**2*k3**2*xb1 - 2*C*k2**4*st**2*xb1 + 2*C*k2**2*k3**2*st**2*xb1 - 2*C*k2**2*k3**2*st**2*yb1 + 2*C*k3**4*st**2*yb1 + b2*k3**2*st**2*(k1**2 - 6*k2**2*st**2) + 2*g2*st**2*(k1**2 - 6*k2**2*st**2)*(k2**2 - k3**2) + 12*k1**2*k2**2*xb1 - k1**2*k3**2*st**2*xb1*yb1 - 12*k1**2*k3**2*xb1 + k2**4*st**2*xb1 - k2**2*k3**2*st**2*xb1 + k2**2*k3**2*st**2*yb1 - k3**4*st**2*yb1) + 462*g2*(k2**2 - k3**2)*(-2*k1**2*xb1 + st**2*(k2**2*xb1 + k3**2*yb1)) + 231*k3**2*(-2*b2*k1**2*xb1 + b2*st**2*(k2**2*xb1 + k3**2*yb1) + 2*xb1*yb1*(2*C - 1)*(k2**2 - k3**2))))/(3465*k2*k3**4)
        
    @staticmethod
    def l4(cosmo_funcs,k1,k2,k3=None,theta=None,zz=0,r=0,s=0):
        
        #get generic cosmology parameters
        k1,k2,k3,theta,Pk1,Pk2,Pk3,f,D1,K,C,b1,xb1,yb1,b2,xb2,yb2,g2,xg2,yg2 = cosmo_funcs.unpack_bk(k1,k2,k3,theta,zz)
        
        ct = np.cos(theta)
        st = np.sin(theta)

        return 2*np.sqrt(np.pi)*D1**4*Pk1*Pk2*f**2*(-13*b1*(176*ct**6*k1*k2**3*(C - 1) - 8*ct**5*k2**2*(15*f*k3**2 + k1**2*(55 - 44*C) + 11*k2**2) + 8*ct**4*k1*k2*(22*k1**2*(C - 2) - 22*k2**2*(3*C*st**2 + C - 3*st**2 + 1) - k3**2*(30*f + 11*yb1)) - 8*ct**3*(11*k1**4 + k1**2*(11*k2**2*(6*C*st**2 + 4*C - 9*st**2 + 1) + k3**2*(15*f + 11*yb1)) - 33*k2**4*st**2 + k2**2*k3**2*(-20*f*st**2 + 11*xb1 + 11*yb1)) - 2*ct**2*k1*k2*(44*C*k1**2*(st**2 + 2) - 33*C*k2**2*st**2*(st**2 + 8) - 96*f*k3**2*st**2 - 176*k1**2*st**2 + 33*k2**2*st**4 - 132*k2**2*st**2 - 132*k3**2*st**2*yb1 + 88*k3**2*xb1 + 44*k3**2*yb1) + ct*(44*k1**4*st**2 + k1**2*(11*k2**2*st**2*(48*C - 3*st**2 + 4) + 4*k3**2*(12*f*st**2 + 33*st**2*yb1 - 22*xb1)) - 33*k2**4*st**4 + 3*k2**2*k3**2*st**2*(35*f*st**2 + 44*xb1 + 44*yb1)) + k1*k2*st**2*(22*C*(4*k1**2 - 3*k2**2*st**2) + k3**2*(42*f*st**2 - 33*st**2*yb1 + 88*xb1 + 44*yb1))) - 3120*ct**6*f*k1*k2**3*(C - 1) + 120*ct**5*f*k2**2*(14*f*k3**2 + k1**2*(65 - 52*C) + 13*k2**2) + 8*ct**4*k1*k2*(420*f**2*k3**2 - 39*f*(10*k1**2*(C - 2) - 2*k2**2*(4*C*st**2 + 5*C - 4*st**2 + 5) - 5*k3**2*yb1) - 286*k2**2*xb1*(C - 1) - 143*k3**2*(yb1*(K - 1) - 2*yg2)) + 8*ct**3*(15*f**2*k3**2*(14*k1**2 - 5*k2**2*st**2) + 39*f*(5*k1**4 + k1**2*(k2**2*(8*C*st**2 + 20*C - 12*st**2 + 5) + 5*k3**2*yb1) - 4*k2**4*st**2 + 5*k2**2*k3**2*(xb1 + yb1)) - 143*k1**2*(k2**2*xb1*(4*C - 5) - k3**2*yb1) + 143*k2**2*(k2**2*xb1 + k3**2*yb1)) + 2*ct**2*k1*k2*(13*C*(8*f*k1**2*(2*st**2 + 15) + 3*f*k2**2*st**2*(7*st**2 - 32) - 88*k1**2*xb1 + 44*k2**2*xb1*(st**2 + 2)) - 360*f**2*k3**2*st**2 - 13*f*(64*k1**2*st**2 + 3*k2**2*st**2*(7*st**2 + 16) - 12*k3**2*(10*xb1 + yb1*(5 - 4*st**2))) + 2288*k1**2*xb1 - 572*k2**2*xb1*(st**2 - 2) + 286*k3**2*(yb1*(K*(st**2 + 2) - st**2 + 2*xb1 + 2) + 2*yb2 - 2*yg2*(st**2 + 2))) - ct*(15*f**2*k3**2*st**2*(12*k1**2 + 37*k2**2*st**2) + 13*f*(16*k1**4*st**2 + k1**2*(k2**2*st**2*(192*C + 21*st**2 + 16) + 24*k3**2*(2*st**2*yb1 - 5*xb1)) + 21*k2**4*st**4 + 48*k2**2*k3**2*st**2*(xb1 + yb1)) - 1144*k1**4*xb1 - 572*k1**2*(k2**2*xb1*(8*C - st**2 + 2) - k3**2*yb1*(st**2 - 2*xb1)) + 572*k2**2*(k2**2*st**2*xb1 + k3**2*yb1*(st**2 - 2*xb1))) - k1*k2*(26*C*(16*f*k1**2*st**2 + 21*f*k2**2*st**4 - 88*k1**2*xb1 + 44*k2**2*st**2*xb1) + k3**2*(222*f**2*st**4 + 13*f*st**2*(32*xb1 + yb1*(21*st**2 + 16)) + 572*st**2*(yb1*(K + xb1 + 1) + yb2 - 2*yg2) - 1144*xb1*yb1)))/(15015*k1*k2*k3**2) - 2*np.sqrt(np.pi)*D1**4*Pk1*Pk3*f**2*(13*b1*(176*ct**6*k1*k2**4*(C - 1) + 8*ct**5*k2**3*(15*f*k2**2 + 11*k1**2*(8*C - 7) + 11*k3**2) + 8*ct**4*k1*k2**2*(45*f*k2**2 + 33*k1**2*(4*C - 3) - 11*k2**2*(6*st**2*(C - 1) + xb1) - 11*k3**2*(2*C - 3)) + 8*ct**3*k2*(-20*f*k2**4*st**2 + 11*k1**4*(8*C - 5) + k1**2*(45*f*k2**2 - 33*k2**2*(st**2*(6*C - 5) + xb1) - 11*k3**2*(4*C - 3)) + 11*k2**2*k3**2*(-3*st**2 + xb1 + yb1)) + 2*ct**2*k1*(-144*f*k2**4*st**2 + 44*k1**4*(2*C - 1) + 4*k1**2*(15*f*k2**2 - 11*k2**2*(st**2*(19*C - 13) + 3*xb1) - 11*k3**2*(2*C - 1)) + 33*k2**4*st**2*(st**2*(C - 1) + 4*xb1) + 44*k2**2*k3**2*(6*st**2*(C - 1) + 2*xb1 + yb1)) - ct*k2*(105*f*k2**4*st**4 + 44*k1**4*(st**2*(16*C - 9) + 2*xb1) + k1**2*(144*f*k2**2*st**2 - 33*k2**2*st**2*(st**2*(4*C - 3) + 12*xb1) - 44*k3**2*(st**2*(12*C - 7) + 2*xb1)) - 33*k2**2*k3**2*st**2*(st**2 - 4*xb1 - 4*yb1)) - k1*st**2*(63*f*k2**4*st**2 + 44*k1**4*(2*C - 1) + k1**2*(16*f*k2**2 - 33*k2**2*(st**2*(2*C - 1) + 4*xb1) - 11*k3**2*(8*C - 4)) + 33*k2**4*st**2*xb1 + 11*k2**2*k3**2*(st**2*(6*C - 3) + 8*xb1 + 4*yb1))) + 3120*ct**6*f*k1*k2**4*(C - 1) + 120*ct**5*f*k2**3*(14*f*k2**2 + 13*k1**2*(8*C - 7) + 13*k3**2) + 8*ct**4*k1*k2**2*(630*f**2*k2**2 + 39*f*(15*k1**2*(4*C - 3) + k2**2*(-8*st**2*(C - 1) - 5*xb1) - 5*k3**2*(2*C - 3)) + 143*k2**2*(xb1*(K - 1) - 2*xg2) + 286*k3**2*yb1*(C - 1)) + 8*ct**3*k2*(15*f**2*(42*k1**2*k2**2 - 5*k2**4*st**2) + 39*f*(5*k1**4*(8*C - 5) + k1**2*(k2**2*(-4*st**2*(6*C - 5) - 15*xb1) - 5*k3**2*(4*C - 3)) + k2**2*k3**2*(-4*st**2 + 5*xb1 + 5*yb1)) + 143*k1**2*(k2**2*(4*K*xb1 - 3*xb1 - 8*xg2) + k3**2*yb1*(4*C - 3)) + 143*k2**2*k3**2*xb1 + 143*k3**4*yb1) + 2*ct**2*k1*(60*f**2*(14*k1**2*k2**2 - 9*k2**4*st**2) + 13*f*(60*k1**4*(2*C - 1) - 4*k1**2*(k2**2*(st**2*(76*C - 52) + 45*xb1) + 15*k3**2*(2*C - 1)) + 3*k2**2*(k2**2*st**2*(-7*st**2*(C - 1) + 16*xb1) + 4*k3**2*(8*st**2*(C - 1) + 10*xb1 + 5*yb1))) + 572*k1**2*(3*k2**2*(2*K*xb1 - xb1 - 4*xg2) + k3**2*yb1*(2*C - 1)) + 286*k2**4*st**2*(-K*xb1 + xb1 + 2*xg2) - 572*k2**2*k3**2*(C*st**2*yb1 - st**2*yb1 + xb1*(K + yb1 - 2) + xb2 - 2*xg2) + 572*k3**4*yb1*(1 - 2*C)) - ct*k2*(15*f**2*(36*k1**2*k2**2*st**2 + 37*k2**4*st**4) + 13*f*(8*k1**4*(2*st**2*(16*C - 9) + 15*xb1) - k1**2*(3*k2**2*st**2*(-7*st**2*(4*C - 3) + 48*xb1) + 8*k3**2*(2*st**2*(12*C - 7) + 15*xb1)) + 3*k2**2*k3**2*st**2*(7*st**2 + 16*xb1 + 16*yb1)) + 1144*k1**4*(-4*K*xb1 + xb1 + 8*xg2) + 572*k1**2*(k2**2*st**2*(xb1*(2*K - 1) - 4*xg2) + k3**2*(4*C*st**2*yb1 - 3*st**2*yb1 + 2*xb1*(2*K + yb1 - 1) + 4*xb2 - 8*xg2)) + 572*k2**2*k3**2*st**2*xb1 + 572*k3**4*yb1*(st**2 - 2*xb1)) + k1*(572*K*xb1*(k1**2 - k3**2)*(2*k1**2 - k2**2*st**2) - 3*f**2*(20*k1**2*k2**2*st**2 + 111*k2**4*st**4) - 13*f*st**2*(16*k1**4*(2*C - 1) + k1**2*(3*k2**2*(7*st**2*(2*C - 1) - 16*xb1) + k3**2*(16 - 32*C)) - 21*k2**4*st**2*xb1 + k2**2*k3**2*(st**2*(21 - 42*C) + 32*xb1 + 16*yb1)) - 2288*k1**4*xg2 + 572*k1**2*(2*k2**2*st**2*xg2 + k3**2*(st**2*yb1*(1 - 2*C) - 2*xb2 + 4*xg2)) + 572*k3**2*st**2*(k2**2*(xb1*yb1 + xb2 - 2*xg2) + k3**2*yb1*(2*C - 1))))/(15015*k1*k3**4) - 2*np.sqrt(np.pi)*D1**4*Pk2*Pk3*f**2*(8*ct**6*k1**2*k2**3*(143*b1*(K - 1) + 210*f**2 + 390*f*(C - 1) - 286*g2) + 8*ct**5*k1*k2**2*(13*b1*(22*k1**2*(K - 1) + k2**2*(22*K - 15*f - 11) + k3**2*(15*f + 11)) + 630*f**2*k1**2 + 195*f*(4*k1**2*(C - 1) + k2**2*(4*C - 3) + k3**2) - 572*g2*(k1**2 + k2**2)) + 4*ct**4*k2*(26*b1*(11*K*k2**2*(k2**2 - k3**2) + 11*k1**4*(K - 1) + k1**2*(k2**2*(-33*K*st**2 + 44*K - 45*f + 33*st**2 - 22) + 2*k3**2*(15*f + 11))) - 286*b2*k2**2*k3**2 + 45*f**2*(28*k1**4 - 5*k1**2*k2**2*st**2) + 78*f*(10*k1**4*(C - 1) + k1**2*(k2**2*(-8*C*(st**2 - 5) + 8*st**2 + 5*xb1 - 30) + 5*k3**2*(yb1 + 2)) + 5*k2**2*(2*C - 1)*(k2**2 - k3**2)) - 572*g2*(k1**4 + k1**2*k2**2*(4 - 3*st**2) + k2**4 - k2**2*k3**2) + 572*k1**2*(C - 1)*(k2**2*xb1 + k3**2*yb1)) + 8*ct**3*k1*(572*C*k1**2*k2**2*xb1 + 572*C*k2**4*xb1 + 572*C*k2**2*k3**2*yb1 - 143*b1*(2*K*k2**2*(k2**2*(3*st**2 - 1) + k3**2) + k1**2*(k2**2*(3*K*st**2 - 2*K - 3*st**2 + 1) - k3**2) - (k2**2 - k3**2)*(k2**2*(3*st**2 - xb1) - k3**2*yb1)) - 286*b2*k2**2*k3**2 + 15*f**2*(14*k1**4 - 15*k1**2*k2**2*st**2) - 13*f*(3*k1**2*(k2**2*(8*C*st**2 - 20*C + 15*b1 - 8*st**2 - 15*xb1 + 15) - 5*k3**2*(b1 + yb1 + 1)) + 2*k2**2*(k2**2*(6*C*(4*st**2 - 5) - 2*st**2*(5*b1 + 9) + 15) + k3**2*(30*C + 2*st**2*(5*b1 + 3) - 15))) + 858*g2*k1**2*k2**2*st**2 - 572*g2*k1**2*k2**2 + 1716*g2*k2**4*st**2 - 572*g2*k2**4 + 572*g2*k2**2*k3**2 - 572*k1**2*k2**2*xb1 - 429*k2**4*xb1 + 143*k2**2*k3**2*xb1 - 429*k2**2*k3**2*yb1 + 143*k3**4*yb1) - ct**2*k2*(13*b1*(11*K*(4*k1**4*st**2 + k1**2*(k2**2*(-3*st**4 + 48*st**2 - 8) + 8*k3**2) + 24*k2**2*st**2*(k2**2 - k3**2)) + 24*f*k1**2*(5*k1**2 + 4*st**2*(-3*k2**2 + 2*k3**2)) + 11*k1**2*(-4*k1**2*st**2 + 3*k2**2*(st**4 - 8*st**2 + 8*xb1) + 8*k3**2*(3*st**2 - 2*xb1 + yb1))) + 1144*b2*k3**2*(k1**2 - 3*k2**2*st**2) + 45*f**2*(24*k1**4*st**2 + 37*k1**2*k2**2*st**4) + 26*f*(4*k1**4*(4*st**2*(C - 1) - 45*xb1) + 3*k1**2*(k2**2*(C*(7*st**4 + 64*st**2 - 40) - 7*st**4 + 16*st**2*(xb1 - 3) + 20) + 4*k3**2*(10*C + 4*st**2*(yb1 + 1) - 5)) + 48*k2**2*st**2*(2*C - 1)*(k2**2 - k3**2)) - 1144*g2*k1**4*st**2 - 286*g2*k1**2*(k2**2*(-3*st**4 + 48*st**2 - 8) + 8*k3**2) - 6864*g2*k2**2*st**2*(k2**2 - k3**2) - 2288*k1**4*xb1*(C - 1) - 1144*k1**2*(k2**2*xb1*(-C*(st**2 - 8) + st**2 - 6) + k3**2*(-st**2*yb1*(C - 1) + xb1*(yb1 + 2))) - 1144*(2*C - 1)*(k2**2 - k3**2)*(k2**2*xb1 + k3**2*yb1)) - ct*k1*(-4576*C*k1**2*k2**2*xb1 + 2288*C*k2**4*st**2*xb1 - 4576*C*k2**4*xb1 + 2288*C*k2**2*k3**2*st**2*yb1 + 4576*C*k2**2*k3**2*xb1 + 143*b1*(4*k1**2*(k2**2*(st**2*(2*K - 1) + 6*xb1) + k3**2*(st**2 - 2*xb1)) - 3*st**2*(2*K*(k2**4*(st**2 - 4) + 4*k2**2*k3**2) - (k2**2 - k3**2)*(k2**2*(st**2 - 4*xb1) - 4*k3**2*yb1))) - 3432*b2*k2**2*k3**2*st**2 + 45*f**2*(4*k1**4*st**2 + 37*k1**2*k2**2*st**4) - 13*f*(120*k1**4*xb1 + 16*k1**2*st**2*(k2**2*(-4*C + 9*b1 - 9*xb1 + 3) - k3**2*(3*b1 + 3*yb1 + 1)) - 3*k2**2*st**2*(k2**2*(4*C*(7*st**2 + 16) - 7*st**2*(5*b1 + 3) - 32) + k3**2*(-64*C + 7*st**2*(5*b1 + 1) + 32))) - 572*g2*k2**2*st**2*(4*k1**2 - 3*k2**2*(st**2 - 4) - 12*k3**2) + 3432*k1**2*k2**2*xb1 - 1144*k1**2*k3**2*xb1*yb1 - 1144*k1**2*k3**2*xb1 - 1716*k2**4*st**2*xb1 + 2288*k2**4*xb1 + 572*k2**2*k3**2*st**2*xb1 - 1716*k2**2*k3**2*st**2*yb1 - 2288*k2**2*k3**2*xb1 + 572*k3**4*st**2*yb1) + k2*(13*b1*(11*K*st**2*(-4*k1**2 + 3*k2**2*st**2)*(k2**2 - k3**2) + 16*f*k1**4*st**2 + 21*f*k1**2*st**4*(3*k2**2 - 2*k3**2) - 88*k1**4*xb1 + 44*k1**2*st**2*(3*k2**2*xb1 + k3**2*(-2*xb1 + yb1))) + 143*b2*k3**2*st**2*(4*k1**2 - 3*k2**2*st**2) - 9*f**2*(37*k1**4*st**4 + 15*k1**2*k2**2*st**6) - 13*f*st**2*(48*k1**4*xb1 + k1**2*(k2**2*(32*C + 21*st**2*xb1 - 16) + k3**2*(-32*C + 21*st**2*yb1 + 16)) + 21*k2**2*st**2*(2*C - 1)*(k2**2 - k3**2)) + 286*g2*st**2*(4*k1**2 - 3*k2**2*st**2)*(k2**2 - k3**2) + 572*k1**2*xb1*(k2**2*(4*C - 2) - k3**2*(4*C + st**2*yb1 - 2)) - 572*st**2*(2*C - 1)*(k2**2 - k3**2)*(k2**2*xb1 + k3**2*yb1)))/(15015*k2*k3**4)